CREATE TABLE CAD_PRODUTO_FATOPESAIDA (
    COD_CADPRODUTO        I NOT NULL /* I = INTEGER */,
    COD_FATOPERACAOSAIDA  I NOT NULL /* I = INTEGER */
);

ALTER TABLE CAD_PRODUTO_FATOPESAIDA ADD CONSTRAINT PK_CAD_PRODUTO_FATOPESAIDA PRIMARY KEY (COD_CADPRODUTO);
ALTER TABLE CAD_PRODUTO_FATOPESAIDA ADD CONSTRAINT FK_CAD_PRODUTO_FATOPESAIDA FOREIGN KEY (COD_CADPRODUTO) REFERENCES CAD_PRODUTO (COD_CADPRODUTO) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE CAD_PRODUTO_FATOPESAIDA ADD CONSTRAINT FK_CAD_PRODUTO_FATOPESAIDA_1 FOREIGN KEY (COD_FATOPERACAOSAIDA) REFERENCES FAT_OPERACAO_SAIDA (COD_FATOPERACAOSAIDA) ON UPDATE CASCADE;

CREATE OR ALTER VIEW V_CAD_PRODUTO_FATOPESAIDA(
    COD_CADPRODUTO,
    CODIGO,
    PRODUTO,
    COD_FATOPERACAOSAIDA,
    OPERACAO_SAIDA)
AS
SELECT A.COD_CADPRODUTO,B.CODIGO, B.NOME AS PRODUTO, A.COD_FATOPERACAOSAIDA,C.NOME AS OPERACAO_SAIDA
FROM CAD_PRODUTO_FATOPESAIDA A
INNER JOIN CAD_PRODUTO B ON B.COD_CADPRODUTO = A.COD_CADPRODUTO
INNER JOIN FAT_OPERACAO_SAIDA C ON C.COD_FATOPERACAOSAIDA = A.COD_FATOPERACAOSAIDA
;

SELECT
 DISTINCT
 ' INSERT INTO CAD_PRODUTO_FATOPESAIDA VALUES ('||COD_CADPRODUTO||','||COD_FATOPERACAOSAIDA||');'
FROM FAT_ROMANEIO_PAO_ITEM;